{
  "hash": "e4342d0726abbc2cb35315dbdf546a70",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lecture 8: Introduction to QTL Analysis\"\ndate: 2025-04-21\nauthor: Haky Im\ncategories:\n  - bios25328\n  - lecture\neditor_options: \n  chunk_output_type: console\neval: true\nfreeze: true\n---\n\n\n\nFind the lecture notes [here](https://www.icloud.com/keynote/01ds9IMhspe5AI_rzDoEime0g#L8-QTL-analysis-GTEx-2025)\n\n# Introduction to QTL Analysis\n\n## Overview\n\nThis lecture covers the core concepts of Quantitative Trait Locus (QTL) analysis, its applications in understanding complex traits and disease susceptibility, and the integration of various genomic resources like GWAS Catalog, ENCODE and GTEx project to understand the mechanisms underlying complex traits.\n\n## Learning Objectives\n\nBy the end of this lecture, you should be able to:\n\n1. Understand the purpose and applications of QTL analysis\n2. Describe the GTEx project and its key findings\n3. Understand fine-mapping methods and their applications\n4. Explain functional annotation and heritability partitioning methods\n\n## Lecture Summary\n\n### I. Introduction to QTL Analysis\n\n#### A. Definition and Purpose\n- QTL analysis aims to identify genetic variants that influence gene expression levels and other molecular traits (e.g., protein levels, DNA methylation, etc.)\n- These expression QTLs (eQTLs) can help identify genes that influence complex traits and disease susceptibility\n- By linking genetic variation to gene expression changes, QTL analysis provides insights into the molecular mechanisms underlying complex traits\n\n#### B. GWAS Catalog\n- Tracks findings from Genome-Wide Association Studies\n- Contains data on numerous loci associated with various traits, including cancer\n- A large proportion of GWAS catalog variants are located in non-coding regions\n\n### II. Mechanisms Linking Genetic Variation to Complex Traits\n\n#### A. Protein Levels and Disease Risk\n- Genetic variation can affect disease risk by influencing protein levels\n- eQTLs (expression Quantitative Trait Loci) and pQTLs (protein Quantitative Trait Loci) play key roles\n\n#### B. mRNA and Splicing\n- Genetic variants primarily affect complex traits through mRNA regulation and pre-mRNA splicing\n- RNA splicing is another key link between genetic variation and disease\n\n### III. The GTEx Project\n\n#### A. Goals and Objectives\n- Characterize genetic effects on the transcriptome across human tissues\n- Connect regulatory mechanisms to trait and disease associations\n\n#### B. Data and Samples\n- Large dataset of tissue samples from human donors\n- Includes various tissue types, mRNA-seq data, and WGS data\n\n#### C. Key Findings\n- eQTLs are genetic variants associated with mRNA levels\n- Number of eGenes increases with sample size\n- Reveals complex patterns of cis- and trans-QTLs\n- Identifies sex-biased and population-biased eQTLs\n\n### IV. Fine-Mapping\n\n#### A. Definition and Purpose\n- Identifies specific causal variants within GWAS-associated regions\n\n#### B. Methods\n- Analysis of association results for potential causal variants\n- Building credible sets of SNPs\n- Calculating posterior probabilities of causality\n\n#### C. Fine-mapping Methods\n- CAVIAR\n- Finemap\n- fastPAINTOR\n- DAP-G\n- SUSIE\n\n### V. Functional Annotation and Enrichment\n\n#### A. QTLs and Functional Annotations\n- Enrichment analysis of cis- and trans-QTLs in functional annotations\n\n#### B. GWAS-Associated SNPs and QTLs\n- GWAS-associated SNPs are enriched among cis-e/sQTLs\n\n#### C. ENCODE Project\n- Catalogs functional elements in the human genome\n- Provides information on regulatory elements\n\n### VI. Partitioning Heritability\n\n#### A. Methods\n- Understanding contribution of different genetic and functional categories\n- LD Score Regression\n- Functional Annotation Enrichment analysis\n\n## Practical Analysis: Download and analyze the GWAS Catalog\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressMessages(library(tidyverse))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'purrr' was built under R version 4.3.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'lubridate' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nsuppressMessages(library(glue))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'glue' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\n# Set up working directory\nPRE = \"~/Downloads/\"\nDATA = glue(\"{PRE}/2025-04-21-gwas-catalog-analysis-2025\")\nif(!file.exists(DATA)) system(glue(\"mkdir -p {DATA}\"))\nWORK = DATA\n\nDOWNLOAD_DATE = \"2025-04-21\"\n\n# Download GWAS catalog data\nDATAFILE = \"full\"\nfilename = glue(\"{DATA}/{DATAFILE}\")\n\nif(!file.exists(filename)) {\n  system(glue(\"wget -P {DATA} https://www.ebi.ac.uk/gwas/api/search/downloads/full\"))\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read and explore GWAS catalog data\ngwascatalog = read_tsv(filename)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat <- vroom(...)\n  problems(dat)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 796754 Columns: 34\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr  (23): FIRST AUTHOR, JOURNAL, LINK, STUDY, DISEASE/TRAIT, INITIAL SAMPLE...\ndbl   (9): PUBMEDID, UPSTREAM_GENE_DISTANCE, DOWNSTREAM_GENE_DISTANCE, MERGE...\ndate  (2): DATE ADDED TO CATALOG, DATE\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ndim(gwascatalog)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 796754     34\n```\n\n\n:::\n\n```{.r .cell-code}\nnames(gwascatalog)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"DATE ADDED TO CATALOG\"      \"PUBMEDID\"                  \n [3] \"FIRST AUTHOR\"               \"DATE\"                      \n [5] \"JOURNAL\"                    \"LINK\"                      \n [7] \"STUDY\"                      \"DISEASE/TRAIT\"             \n [9] \"INITIAL SAMPLE SIZE\"        \"REPLICATION SAMPLE SIZE\"   \n[11] \"REGION\"                     \"CHR_ID\"                    \n[13] \"CHR_POS\"                    \"REPORTED GENE(S)\"          \n[15] \"MAPPED_GENE\"                \"UPSTREAM_GENE_ID\"          \n[17] \"DOWNSTREAM_GENE_ID\"         \"SNP_GENE_IDS\"              \n[19] \"UPSTREAM_GENE_DISTANCE\"     \"DOWNSTREAM_GENE_DISTANCE\"  \n[21] \"STRONGEST SNP-RISK ALLELE\"  \"SNPS\"                      \n[23] \"MERGED\"                     \"SNP_ID_CURRENT\"            \n[25] \"CONTEXT\"                    \"INTERGENIC\"                \n[27] \"RISK ALLELE FREQUENCY\"      \"P-VALUE\"                   \n[29] \"PVALUE_MLOG\"                \"P-VALUE (TEXT)\"            \n[31] \"OR or BETA\"                 \"95% CI (TEXT)\"             \n[33] \"PLATFORM [SNPS PASSING QC]\" \"CNV\"                       \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Analyze cancer-related entries\ngwascatalog %>% \n  select(`DISEASE/TRAIT`, MAPPED_GENE) %>% \n  filter(grepl(\"cancer\", `DISEASE/TRAIT`)) %>% \n  dim()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 13091     2\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Count unique cancer loci\n# gwascatalog %>% \n#   select(`DISEASE/TRAIT`, MAPPED_GENE) %>% \n#   filter(grepl(\"cancer\", `DISEASE/TRAIT`)) %>% \n#   unique() %>% \n#   dim() \n# this double counts many genes\n# will use \n\n# unique cytogenetic locations (some double counting because of cytogenetic locations reported with different subbands)\ngwascatalog %>% \nselect(`DISEASE/TRAIT`, REGION) %>% \nfilter(grepl(\"cancer\",`DISEASE/TRAIT`)) %>% \nunique() %>% \ndim()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 5536    2\n```\n\n\n:::\n\n```{.r .cell-code}\n# print \ngwascatalog %>% \nselect(`DISEASE/TRAIT`, REGION) %>% \nfilter(grepl(\"cancer\",`DISEASE/TRAIT`)) %>% \ncount(REGION) %>% \narrange(desc(n))  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 816 × 2\n   REGION       n\n   <chr>    <int>\n 1 <NA>      1012\n 2 8q24.21    529\n 3 5p15.33    230\n 4 11q13.3    157\n 5 6p22.1     155\n 6 6p21.33    154\n 7 17q12      110\n 8 6p21.32    106\n 9 10q26.13    86\n10 19q13.33    83\n# ℹ 806 more rows\n```\n\n\n:::\n:::\n\n\n\n:::{.callout-note}\n## 8q24.21 is a hot spot of cancer susceptibility variants\n\nThe REGION column in the GWAS catalog uses standard cytogenetic band notation. For example, \"8q24.21\" refers to:\n- Chromosome 8\n- Long arm (q)\n- Band 24\n- Sub-band 21\n\nThis region (8q24.21) is particularly well-known as it contains multiple cancer susceptibility loci, including those associated with prostate cancer, breast cancer, and colorectal cancer.\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot GWAS loci by year\ngwascat_sig = gwascatalog %>% \n  mutate(year = as.factor(lubridate::year(lubridate::as_date(`DATE ADDED TO CATALOG`)))) %>% \n  filter(`P-VALUE` < 5e-8)\n\ngwascat_sig %>% \n  filter(year != \"2024\") %>% \n  ggplot(aes(year)) + \n  geom_bar() + \n  theme_bw(base_size = 15) + \n  scale_x_discrete(breaks = c(\"2008\", \"2012\", \"2016\", \"2020\", \"2022\")) + \n  xlab(\"Year\") + \n  ylab(\"GWAS loci reported (p < 5e-8)\") + \n  ggtitle(paste0(\"GWAS Catalog Downloaded \", DOWNLOAD_DATE))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}